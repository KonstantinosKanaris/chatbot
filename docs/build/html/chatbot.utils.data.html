<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>chatbot.utils.data package &mdash; chatbot  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            chatbot
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">chatbot.utils.data package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-chatbot.utils.data.datasets">chatbot.utils.data.datasets module</a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.datasets.CornellDialogsDataset"><code class="docutils literal notranslate"><span class="pre">CornellDialogsDataset</span></code></a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.datasets.CornellDialogsDataset.get_num_batches"><code class="docutils literal notranslate"><span class="pre">CornellDialogsDataset.get_num_batches()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.datasets.CornellDialogsDataset.get_vectorizer"><code class="docutils literal notranslate"><span class="pre">CornellDialogsDataset.get_vectorizer()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.datasets.CornellDialogsDataset.load_pairs_and_vectorizer"><code class="docutils literal notranslate"><span class="pre">CornellDialogsDataset.load_pairs_and_vectorizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-chatbot.utils.data.vectorizer">chatbot.utils.data.vectorizer module</a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer"><code class="docutils literal notranslate"><span class="pre">SequenceVectorizer</span></code></a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer.from_serializable"><code class="docutils literal notranslate"><span class="pre">SequenceVectorizer.from_serializable()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer.vectorize"><code class="docutils literal notranslate"><span class="pre">SequenceVectorizer.vectorize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-chatbot.utils.data.vocabulary">chatbot.utils.data.vocabulary module</a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary</span></code></a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.token_to_idx"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.token_to_idx</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._unk_token"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary._unk_token</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._mask_token"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary._mask_token</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._begin_seq_token"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary._begin_seq_token</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._end_seq_token"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary._end_seq_token</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.unk_index"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.unk_index</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.mask_index"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.mask_index</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.start_seq_index"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.start_seq_index</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.end_seq_index"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.end_seq_index</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.lookup_token"><code class="docutils literal notranslate"><span class="pre">SequenceVocabulary.lookup_token()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary"><code class="docutils literal notranslate"><span class="pre">Vocabulary</span></code></a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary.token_to_idx"><code class="docutils literal notranslate"><span class="pre">Vocabulary.token_to_idx</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary.add_many"><code class="docutils literal notranslate"><span class="pre">Vocabulary.add_many()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary.add_token"><code class="docutils literal notranslate"><span class="pre">Vocabulary.add_token()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary.lookup_index"><code class="docutils literal notranslate"><span class="pre">Vocabulary.lookup_index()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary.lookup_token"><code class="docutils literal notranslate"><span class="pre">Vocabulary.lookup_token()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder</span></code></a><ul>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.pairs"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.pairs</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.tokenizer"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.tokenizer</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.build_vocabulary"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.build_vocabulary()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_length"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.filter_pairs_by_length()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_token_count"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.filter_pairs_by_token_count()</span></code></a></li>
<li><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.from_txt_file"><code class="docutils literal notranslate"><span class="pre">VocabularyBuilder.from_txt_file()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-chatbot.utils.data">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">chatbot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">chatbot.utils.data package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/chatbot.utils.data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="chatbot-utils-data-package">
<h1>chatbot.utils.data package<a class="headerlink" href="#chatbot-utils-data-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-chatbot.utils.data.datasets">
<span id="chatbot-utils-data-datasets-module"></span><h2>chatbot.utils.data.datasets module<a class="headerlink" href="#module-chatbot.utils.data.datasets" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chatbot.utils.data.datasets.CornellDialogsDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chatbot.utils.data.datasets.</span></span><span class="sig-name descname"><span class="pre">CornellDialogsDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence_pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vectorizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer" title="chatbot.utils.data.vectorizer.SequenceVectorizer"><span class="pre">SequenceVectorizer</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chatbot.utils.data.datasets.CornellDialogsDataset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Dataset</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.datasets.CornellDialogsDataset.get_num_batches">
<span class="sig-name descname"><span class="pre">get_num_batches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chatbot.utils.data.datasets.CornellDialogsDataset.get_num_batches" title="Link to this definition"></a></dt>
<dd><p>Given a batch size, returns the number of batches
in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<em>int</em>) – The batch size.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of batches in the dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.datasets.CornellDialogsDataset.get_vectorizer">
<span class="sig-name descname"><span class="pre">get_vectorizer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer" title="chatbot.utils.data.vectorizer.SequenceVectorizer"><span class="pre">SequenceVectorizer</span></a></span></span><a class="headerlink" href="#chatbot.utils.data.datasets.CornellDialogsDataset.get_vectorizer" title="Link to this definition"></a></dt>
<dd><p>Returns the vectorizer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.datasets.CornellDialogsDataset.load_pairs_and_vectorizer">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_pairs_and_vectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#chatbot.utils.data.datasets.CornellDialogsDataset" title="chatbot.utils.data.datasets.CornellDialogsDataset"><span class="pre">CornellDialogsDataset</span></a></span></span><a class="headerlink" href="#chatbot.utils.data.datasets.CornellDialogsDataset.load_pairs_and_vectorizer" title="Link to this definition"></a></dt>
<dd><p>Initializes the <cite>CornelDialogsDataset</cite> from a <cite>.txt</cite> file
that contains the sequence pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Path to the <cite>.txt</cite> file.</p></li>
<li><p><strong>(</strong><strong>Callable</strong><strong>[</strong><strong>[</strong><strong>str</strong><strong>]</strong> (<em>tokenizer</em>) – Tokenizer for
splitting each sequence before vectorization.</p></li>
<li><p><strong>List</strong><strong>[</strong><strong>str</strong><strong>]</strong><strong>]</strong> – Tokenizer for
splitting each sequence before vectorization.</p></li>
<li><p><strong>min_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of tokens allowed
in each of the pair of sequences (default=1).</p></li>
<li><p><strong>max_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of tokens allowed
in each of the pair sequence (default=10).</p></li>
<li><p><strong>min_count</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum token count value threshold
(default=3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of <cite>CornelDialogsDataset</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>CornelDialogsDataset</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-chatbot.utils.data.vectorizer">
<span id="chatbot-utils-data-vectorizer-module"></span><h2>chatbot.utils.data.vectorizer module<a class="headerlink" href="#module-chatbot.utils.data.vectorizer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chatbot.utils.data.vectorizer.SequenceVectorizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chatbot.utils.data.vectorizer.</span></span><span class="sig-name descname"><span class="pre">SequenceVectorizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vocab</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary" title="chatbot.utils.data.vocabulary.SequenceVocabulary"><span class="pre">SequenceVocabulary</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_seq_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chatbot.utils.data.vectorizer.SequenceVectorizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Responsible for implementing token-level based vectorization
of an input text sequence.</p>
<p>The tokens can be either words or punctuations.</p>
<p>Each token in the input sequence is substituted with each
corresponding index in the sequence vocabulary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vocab</strong> (<a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary" title="chatbot.utils.data.vocabulary.SequenceVocabulary"><em>SequenceVocabulary</em></a>) – Vocabulary object constructed
from dataset’s collection of tokens.</p></li>
<li><p><strong>tokenizer</strong> (<em>Callable</em><em>[</em><em>[</em><em>str</em><em>]</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Tokenizer for
splitting the input sequence into tokens.</p></li>
<li><p><strong>max_seq_length</strong> (<em>int</em>) – The length of the longest sequence
in the dataset.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vectorizer.SequenceVectorizer.from_serializable">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_serializable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">contents</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#chatbot.utils.data.vectorizer.SequenceVectorizer" title="chatbot.utils.data.vectorizer.SequenceVectorizer"><span class="pre">SequenceVectorizer</span></a></span></span><a class="headerlink" href="#chatbot.utils.data.vectorizer.SequenceVectorizer.from_serializable" title="Link to this definition"></a></dt>
<dd><p>Initializes the vectorizer from a serializable
dictionary containing the vocabulary, tokenizer and
the maximum sequence length.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vectorizer.SequenceVectorizer.vectorize">
<span class="sig-name descname"><span class="pre">vectorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_dataset_max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chatbot.utils.data.vectorizer.SequenceVectorizer.vectorize" title="Link to this definition"></a></dt>
<dd><p>Converts an input text sequence into a 1-D tensor of
integers.</p>
<p>The input sequence is padded with zeros to match the maximum
length and is appended with the <cite>&lt;EOS&gt;</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>str</em>) – Input text sequence.</p></li>
<li><p><strong>use_dataset_max_length</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>
the value of <code class="xref py py-attr docutils literal notranslate"><span class="pre">max_seq_length</span></code> is used as
the maximum sequence length. Otherwise, the maximum
length is equal to the number of tokens in the input
sequence. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing</dt><dd><p>the vectorized sequence, the length of the un-padded
sequence and the mask of the sequence where mask is the
boolean version of the vectorized sequence.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[torch.Tensor, int, torch.Tensor]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-chatbot.utils.data.vocabulary">
<span id="chatbot-utils-data-vocabulary-module"></span><h2>chatbot.utils.data.vocabulary module<a class="headerlink" href="#module-chatbot.utils.data.vocabulary" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chatbot.utils.data.vocabulary.</span></span><span class="sig-name descname"><span class="pre">SequenceVocabulary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token_to_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unk_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'&lt;UNK&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'&lt;MASK&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">begin_seq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'&lt;SOS&gt;'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_seq_token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'&lt;EOS&gt;'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#chatbot.utils.data.vocabulary.Vocabulary" title="chatbot.utils.data.vocabulary.Vocabulary"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vocabulary</span></code></a></p>
<p>Bundles four special tokens used for sequence data.</p>
<p>The special tokens are: the <cite>UNK</cite> token, the <cite>MASK</cite> token,
the <cite>START-OF-SEQUENCE</cite> token, and the <cite>END-OF-SEQUENCE</cite>
token where:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>* `UNK`: The unknown token used for unseen out-of-vocabulary
input tokens
* `MASK`: Enables handling variable-length inputs
* `START-OF-SEQUENCE`: Start of sequence boundary
* `END-OF-SEQUENCE`: End of sequence boundary
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>token_to_idx</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – A pre-existing map of tokens to indices. Defaults
to <cite>None</cite>.</p></li>
<li><p><strong>mask_token</strong> (<em>str</em><em>, </em><em>optional</em>) – The representation of the
<cite>MASK</cite> token. Defaults to <cite>&lt;MASK&gt;</cite>.</p></li>
<li><p><strong>unk_token</strong> (<em>str</em><em>, </em><em>optional</em>) – The representation of the
<cite>UNK</cite> token. Defaults to <cite>&lt;UNK&gt;</cite>.</p></li>
<li><p><strong>begin_seq_token</strong> (<em>str</em><em>, </em><em>optional</em>) – The representation of
the <cite>START-OF-SEQUENCE</cite> token. Defaults to <cite>&lt;SOS&gt;</cite>.</p></li>
<li><p><strong>end_seq_token</strong> (<em>str</em><em>, </em><em>optional</em>) – The representation of
the <cite>END-OF-SEQUENCE</cite> token. Defaults to <cite>&lt;EOS&gt;</cite>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.token_to_idx">
<span class="sig-name descname"><span class="pre">token_to_idx</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.token_to_idx" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping tokens to indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">idx_to_token</span> <span class="pre">(Dict[int,</span> <span class="pre">str]</span></span></dt>
<dd><p>A dictionary mapping indices to tokens.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary._unk_token">
<span class="sig-name descname"><span class="pre">_unk_token</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._unk_token" title="Link to this definition"></a></dt>
<dd><p>The representation of the <cite>UNK</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary._mask_token">
<span class="sig-name descname"><span class="pre">_mask_token</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._mask_token" title="Link to this definition"></a></dt>
<dd><p>The representation of the <cite>MASK</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary._begin_seq_token">
<span class="sig-name descname"><span class="pre">_begin_seq_token</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._begin_seq_token" title="Link to this definition"></a></dt>
<dd><p>The representation of the
<cite>START-OF-SEQUENCE</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary._end_seq_token">
<span class="sig-name descname"><span class="pre">_end_seq_token</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary._end_seq_token" title="Link to this definition"></a></dt>
<dd><p>The representation of the
<cite>END-OF-SEQUENCE</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.unk_index">
<span class="sig-name descname"><span class="pre">unk_index</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.unk_index" title="Link to this definition"></a></dt>
<dd><p>Index associated with the <cite>UNK</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.mask_index">
<span class="sig-name descname"><span class="pre">mask_index</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.mask_index" title="Link to this definition"></a></dt>
<dd><p>Index associated with the <cite>MASK</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.start_seq_index">
<span class="sig-name descname"><span class="pre">start_seq_index</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.start_seq_index" title="Link to this definition"></a></dt>
<dd><p>Index associated with the
<cite>START-OF-SEQUENCE</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.end_seq_index">
<span class="sig-name descname"><span class="pre">end_seq_index</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.end_seq_index" title="Link to this definition"></a></dt>
<dd><p>Index associated with the
<cite>END-OF-SEQUENCE</cite> token.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.SequenceVocabulary.lookup_token">
<span class="sig-name descname"><span class="pre">lookup_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.SequenceVocabulary.lookup_token" title="Link to this definition"></a></dt>
<dd><p>Retrieves the index associated with the token or the <cite>UNK</cite> index if
token isn’t found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – The token to look up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index corresponding to the token.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><cite>unk_index</cite> needs to be &gt;=0 (having been added into
the <cite>Vocabulary</cite>) for the <cite>UNK</cite> functionality.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chatbot.utils.data.vocabulary.</span></span><span class="sig-name descname"><span class="pre">Vocabulary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token_to_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_to_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Creates a vocabulary object which maps tokens to indices.</p>
<p>Provides methods for adding new tokens and for searching existing
tokens based on their indices or indices based on their tokens.
Also keeps track of the count value of each token in the vocabulary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token_to_idx</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – A pre-existing mapping
of tokens to indices. Defaults to <cite>None</cite>.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary.token_to_idx">
<span class="sig-name descname"><span class="pre">token_to_idx</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary.token_to_idx" title="Link to this definition"></a></dt>
<dd><p>A dictionary mapping tokens to indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">idx_to_token</span> <span class="pre">(Dict[int,</span> <span class="pre">str]</span></span></dt>
<dd><p>A dictionary mapping indices to tokens.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary.add_many">
<span class="sig-name descname"><span class="pre">add_many</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokens</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary.add_many" title="Link to this definition"></a></dt>
<dd><p>Updates the mapping dictionaries based on a list of input tokens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokens</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of string tokens.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A list of indices corresponding</dt><dd><p>to the tokens.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary.add_token">
<span class="sig-name descname"><span class="pre">add_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary.add_token" title="Link to this definition"></a></dt>
<dd><p>Updates the mapping dictionaries based on the provided token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – The token to be added to the
vocabulary.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index corresponding to the token.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary.lookup_index">
<span class="sig-name descname"><span class="pre">lookup_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary.lookup_index" title="Link to this definition"></a></dt>
<dd><p>Retrieves the token associated with the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – The index to look up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The token corresponding to the index.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the index is not in the vocabulary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.Vocabulary.lookup_token">
<span class="sig-name descname"><span class="pre">lookup_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">token</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.Vocabulary.lookup_token" title="Link to this definition"></a></dt>
<dd><p>Retrieves the index associated with the token.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>token</strong> (<em>str</em>) – The token to look up.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index corresponding to the token.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">chatbot.utils.data.vocabulary.</span></span><span class="sig-name descname"><span class="pre">VocabularyBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Constructs a vocabulary object from a list of query and response
sequence pairs.</p>
<p>Uses a tokenizer for splitting the text into tokens in order
to build the vocabulary. Refer to
<code class="xref py py-func docutils literal notranslate"><span class="pre">chatbot.data.utils.get_tokenizer()</span></code> for the available
tokenizers.</p>
<p>The <cite>VocabularyBuilder</cite> can be initialized from a <cite>.txt</cite> file
in which each line is a tab-separated pair of sequences as it
is shown below.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>1. They do to!  They do not!
2. She okay?    I hope so.
3. Wow  Let&#39;s go.
4. Well, no...  Then that&#39;s all you had to say.
5. Have fun tonight?    Tons
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The query and response
sequence pairs.</p></li>
<li><p><strong>tokenizer</strong> – Optional[str]: Name of a tokenizing
callable function. If <code class="docutils literal notranslate"><span class="pre">None</span></code> a <cite>split()</cite>
tokenizer is used which splits the sequence
by whitespace. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.pairs">
<span class="sig-name descname"><span class="pre">pairs</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.pairs" title="Link to this definition"></a></dt>
<dd><p>The query and response
sequence pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.tokenizer">
<span class="sig-name descname"><span class="pre">tokenizer</span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.tokenizer" title="Link to this definition"></a></dt>
<dd><p>Callable[[str], List[str]]: A callable
tokenizer function.</p>
</dd></dl>

<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chatbot.utils.data.vocabulary</span> <span class="kn">import</span> <span class="n">VocabularyBuilder</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Initialize builder from a txt file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">builder</span> <span class="o">=</span> <span class="n">VocabularyBuilder</span><span class="o">.</span><span class="n">from_txt_file</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">file</span><span class="o">=</span><span class="s2">&quot;./data/dialogs.txt&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create the vocabulary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">builder</span><span class="o">.</span><span class="n">build_vocabulary</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">max_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="mi">3</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.build_vocabulary">
<span class="sig-name descname"><span class="pre">build_vocabulary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary" title="chatbot.utils.data.vocabulary.SequenceVocabulary"><span class="pre">SequenceVocabulary</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.build_vocabulary" title="Link to this definition"></a></dt>
<dd><p>Filters the sequence pairs and builds the vocabulary.</p>
<p>The filtering includes:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>- Removing pairs whose sequences (either of them) include tokens
with count value less than the specified minimum threshold.
- Removing pairs whose sequences (either of them) have length
greater than the specified maximum threshold.
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum number of tokens allowed
in each of the pair of sequences (default=1).</p></li>
<li><p><strong>max_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of tokens allowed
in each of the pair of sequences (default=10).</p></li>
<li><p><strong>min_count</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum token count value threshold
(default=3).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The list of query and</dt><dd><p>response sequence pairs and the populated vocabulary.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[List[List[str]], <a class="reference internal" href="#chatbot.utils.data.vocabulary.SequenceVocabulary" title="chatbot.utils.data.vocabulary.SequenceVocabulary">SequenceVocabulary</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_length">
<span class="sig-name descname"><span class="pre">filter_pairs_by_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_length" title="Link to this definition"></a></dt>
<dd><p>Removing pairs whose sequences (either of them) have length greater
than or equal to the specified maximum threshold..</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The sequence length is essentially the length of the
list of tokens obtained by tokenizing the input sequence.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The query and response
sequence pairs.</p></li>
<li><p><strong>min_length</strong> (<em>int</em>) – Minimum number of tokens allowed in each
of the pair of sequences.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum number of tokens allowed in each
of the pair of sequences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_token_count">
<span class="sig-name descname"><span class="pre">filter_pairs_by_token_count</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.filter_pairs_by_token_count" title="Link to this definition"></a></dt>
<dd><p>Removes pairs whose sequences (either of them) include tokens with
count value less than or equal to the specified minimum threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>List</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The query and response
sequence pairs.</p></li>
<li><p><strong>min_count</strong> (<em>int</em>) – Minimum token count value threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The filtered pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>List[List[str]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="chatbot.utils.data.vocabulary.VocabularyBuilder.from_txt_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_txt_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#chatbot.utils.data.vocabulary.VocabularyBuilder" title="chatbot.utils.data.vocabulary.VocabularyBuilder"><span class="pre">VocabularyBuilder</span></a></span></span><a class="headerlink" href="#chatbot.utils.data.vocabulary.VocabularyBuilder.from_txt_file" title="Link to this definition"></a></dt>
<dd><p>Initializes the <cite>VocabularyBuilder</cite> from a local <cite>.txt</cite> file.</p>
<p>Normalizes each pair of sequences before initialization.
Refer to the <cite>chatbot.data.utils.normalize_text()</cite> function
for what the normalization includes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Path to the <cite>.txt</cite> file.</p></li>
<li><p><strong>tokenizer</strong> – Optional[str]: Name of a tokenizing
callable function. If <code class="docutils literal notranslate"><span class="pre">None</span></code> a <cite>split()</cite>
tokenizer is used which splits the sequence
by whitespace. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An instance of the</dt><dd><p><cite>VocabularyBuilder</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>sequencePairProcessor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-chatbot.utils.data">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-chatbot.utils.data" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Kanaris Konstantinos.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>